<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04">
  <Obj RefId="0">
    <TN RefId="0">
      <T>PILThreadConfig</T>
      <T>System.Object</T>
    </TN>
    <ToString>PILThreadConfig</ToString>
    <Props>
      <Obj N="ColumnNames" RefId="1">
        <TN RefId="1">
          <T>System.String[]</T>
          <T>System.Array</T>
          <T>System.Object</T>
        </TN>
        <LST>
          <S>List Item</S>
          <S>Status</S>
          <S>Terminated Time</S>
          <S>Open Mutex</S>
          <S>Synced Hash</S>
          <S>Fake Error</S>
          <S>Random Number</S>
          <S>WasSuccess</S>
          <S>Update Time 01</S>
          <S>Update Time 02</S>
          <S>Update Time 03</S>
          <S>Update Time 04</S>
          <S>Update Time 05</S>
          <S>Update Time 06</S>
          <S>Update Time 07</S>
          <S>Update Time 08</S>
        </LST>
      </Obj>
      <Obj N="Modules" RefId="2">
        <TN RefId="2">
          <T>System.Collections.Specialized.OrderedDictionary</T>
          <T>System.Object</T>
        </TN>
        <DCT />
      </Obj>
      <Obj N="Functions" RefId="3">
        <TN RefId="3">
          <T>System.Collections.Hashtable</T>
          <T>System.Object</T>
        </TN>
        <DCT />
      </Obj>
      <Obj N="Variables" RefId="4">
        <TNRef RefId="3" />
        <DCT />
      </Obj>
      <U16 N="ThreadCount">4</U16>
      <S N="ThreadScript">&lt;#_x000D__x000A_  .SYNOPSIS_x000D__x000A_    Sample Runspace Pool Thread Script_x000D__x000A_  .DESCRIPTION_x000D__x000A_    Sample Runspace Pool Thread Script_x000D__x000A_  .PARAMETER ListViewItem_x000D__x000A_    ListViewItem Passed to the Thread Script_x000D__x000A__x000D__x000A_    This Paramter is Required in your Thread Script_x000D__x000A_  .EXAMPLE_x000D__x000A_    Test-Script.ps1 -ListViewItem $ListViewItem_x000D__x000A_  .NOTES_x000D__x000A_    Sample Thread Script_x000D__x000A__x000D__x000A_   -------------------------_x000D__x000A_   ListViewItem Status Icons_x000D__x000A_   -------------------------_x000D__x000A_   $GoodIcon = Solid Green Circle_x000D__x000A_   $BadIcon = Solid Red Circle_x000D__x000A_   $InfoIcon = Solid Blue Circle_x000D__x000A_   $CheckIcon = Checkmark_x000D__x000A_   $ErrorIcon = Red X_x000D__x000A_   $UpIcon = Green up Arrow _x000D__x000A_   $DownIcon = Red Down Arrow_x000D__x000A__x000D__x000A_#&gt;_x000D__x000A_[CmdletBinding(DefaultParameterSetName = "ByValue")]_x000D__x000A_Param (_x000D__x000A_  [parameter(Mandatory = $True)]_x000D__x000A_  [System.Windows.Forms.ListViewItem]$ListViewItem_x000D__x000A_)_x000D__x000A__x000D__x000A_$ErrorActionPreference = "Stop"_x000D__x000A_$VerbosePreference = "SilentlyContinue"_x000D__x000A__x000D__x000A_# ------------------------------------------------_x000D__x000A_# Check if Thread was Already Completed and Exit_x000D__x000A_#_x000D__x000A_# One Column needs to be the Status the the Thread_x000D__x000A_#  Status Messages are Customizable_x000D__x000A_# ------------------------------------------------_x000D__x000A_If ($ListViewItem.SubItems[1].Text -eq "Completed")_x000D__x000A_{_x000D__x000A_  $ListViewItem.ImageKey = $GoodIcon_x000D__x000A_  Exit_x000D__x000A_}_x000D__x000A__x000D__x000A_# ----------------------------------------------------_x000D__x000A_# Check if Threads are Paused and Update Thread Status_x000D__x000A_#_x000D__x000A_# You can add Multiple Checks for Pasue if Needed_x000D__x000A_# ----------------------------------------------------_x000D__x000A_If ($SyncedHash.Paused)_x000D__x000A_{_x000D__x000A_  # Set Paused Status_x000D__x000A_  $ListViewItem.SubItems[1].Text = "Pause"_x000D__x000A_  While ($SyncedHash.Paused)_x000D__x000A_  {_x000D__x000A_    [System.Threading.Thread]::Sleep(100)_x000D__x000A_  }_x000D__x000A_}_x000D__x000A__x000D__x000A_# -----------------------------------------------------_x000D__x000A_# Check For Termination and Update Thread Status_x000D__x000A_#_x000D__x000A_# You can add Multiple Checks for Termination if Needed_x000D__x000A_# -----------------------------------------------------_x000D__x000A_If ($SyncedHash.Terminate)_x000D__x000A_{_x000D__x000A_  # Set Terminated Status and Return_x000D__x000A_  $ListViewItem.SubItems[1].Text = "Terminated"_x000D__x000A_  $ListViewItem.SubItems[2].Text = [DateTime]::Now.ToString("g")_x000D__x000A_  $ListViewItem.ImageKey = $InfoIcon_x000D__x000A_  Exit_x000D__x000A_}_x000D__x000A__x000D__x000A_# Set Proccessing Ststus_x000D__x000A_$ListViewItem.SubItems[1].Text = "Processing"_x000D__x000A_$ListViewItem.SubItems[2].Text = [DateTime]::Now.ToString("g")_x000D__x000A_$WasSuccess = $True_x000D__x000A__x000D__x000A_# --------------------------------------------------_x000D__x000A_# Get Curent List Item_x000D__x000A_#_x000D__x000A_# Coulmn 0 Always has the List Item to be Proccessed_x000D__x000A_# --------------------------------------------------_x000D__x000A_$CurentItem = $ListViewItem.SubItems[0].Text_x000D__x000A__x000D__x000A_# --------------------------------------------------------------_x000D__x000A_# Open and wait for Mutex_x000D__x000A_# _x000D__x000A_# This is to Pause the Thread Script if Access a Shared Resource_x000D__x000A_#   and you need toi Limit to 1 Thread at a Time_x000D__x000A_#_x000D__x000A_# Using a Mutext is Optional_x000D__x000A_# --------------------------------------------------------------_x000D__x000A_$MyMutex = [System.Threading.Mutex]::OpenExisting($Mutex)_x000D__x000A_[Void]($MyMutex.WaitOne())_x000D__x000A__x000D__x000A_# Set Date / Time when Mutext was Opened_x000D__x000A_$ListViewItem.SubItems[3].Text = [DateTime]::Now.ToString("g")_x000D__x000A__x000D__x000A_# --------------------------------------------------------------------------------_x000D__x000A_# The Synced HashTable has an Object Property to share information between Threads_x000D__x000A_# --------------------------------------------------------------------------------_x000D__x000A_If ([String]::IsNullOrEmpty($SyncedHash.Object))_x000D__x000A_{_x000D__x000A_  $SyncedHash.Object = "First"_x000D__x000A_}_x000D__x000A_$ListViewItem.SubItems[4].Text = $SyncedHash.Object_x000D__x000A_$SyncedHash.Object = $CurentItem_x000D__x000A__x000D__x000A_# Release Mutex_x000D__x000A_$MyMutex.ReleaseMutex()_x000D__x000A__x000D__x000A_# Random Number Generator_x000D__x000A_$Random = [System.Random]::New()_x000D__x000A__x000D__x000A_# ---------------------------------------------------------_x000D__x000A_# Gernate a Fake Error_x000D__x000A_#_x000D__x000A_# Make sure to use Error Catching to make sure thread exits_x000D__x000A_# ---------------------------------------------------------_x000D__x000A_Try_x000D__x000A_{_x000D__x000A_  Switch ($Random.Next(0, 3))_x000D__x000A_  {_x000D__x000A_    "0"_x000D__x000A_    {_x000D__x000A_      Throw "This is a Fake Error!"_x000D__x000A_      Break_x000D__x000A_    }_x000D__x000A_    "1"_x000D__x000A_    {_x000D__x000A_      Throw "Simulated Error!"_x000D__x000A_      Break_x000D__x000A_    }_x000D__x000A_    "2"_x000D__x000A_    {_x000D__x000A_      Throw "Someing Failed!"_x000D__x000A_      Break_x000D__x000A_    }_x000D__x000A_    "3"_x000D__x000A_    {_x000D__x000A_      Throw "Unknown Error!"_x000D__x000A_      Break_x000D__x000A_    }_x000D__x000A_  }_x000D__x000A_}_x000D__x000A_Catch_x000D__x000A_{_x000D__x000A_  # Save Error Mesage_x000D__x000A_  $ListViewItem.SubItems[5].Text = $Error[0].Exception.Message_x000D__x000A_}_x000D__x000A__x000D__x000A__x000D__x000A_For ($I = 8; $I -lt 16; $I++)_x000D__x000A_{_x000D__x000A_  $ListViewItem.SubItems[$I].Text = [DateTime]::Now.ToString("HH:mm:ss:ffff")_x000D__x000A_  [System.Threading.Thread]::Sleep(100)_x000D__x000A_}_x000D__x000A__x000D__x000A_$RndValue = $Random.Next(0, 3)_x000D__x000A_$ListViewItem.SubItems[6].Text = $RndValue_x000D__x000A_# Random Fail Simlater_x000D__x000A_If ($RndValue -eq 0)_x000D__x000A_{_x000D__x000A_  $WasSuccess = $False_x000D__x000A_}_x000D__x000A_$ListViewItem.SubItems[7].Text = $WasSuccess_x000D__x000A__x000D__x000A_If ($WasSuccess)_x000D__x000A_{_x000D__x000A_  # Return Success_x000D__x000A_  $ListViewItem.ImageKey = $GoodIcon_x000D__x000A_  $ListViewItem.SubItems[1].Text = "Completed"_x000D__x000A_}_x000D__x000A_Else_x000D__x000A_{_x000D__x000A_  # Return Success_x000D__x000A_  $ListViewItem.ImageKey = $BadIcon_x000D__x000A_  $ListViewItem.SubItems[1].Text = "Error"_x000D__x000A_}_x000D__x000A__x000D__x000A_Exit_x000D__x000A__x000D__x000A__x000D__x000A_</S>
    </Props>
  </Obj>
</Objs>